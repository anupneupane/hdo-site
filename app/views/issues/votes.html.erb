<% cache @issue.model do %>
  <div class="page-header votes-header">
    <h1>
      <div class="lead">
        <%= Vote.model_name.human(count: 2).capitalize %> <%= Vote.human_attribute_name(:about) %> <%= t 'app.lang.infinitive_particle' %>
      </div>
      <%= link_to @issue.title, @issue, class: "votes-title" %>
    </h1>

  <%= render partial: 'aside', locals: { issue: @issue } %>
  </div>

  <div class="row-fluid">
    <% @issue_votes.each do |issue_vote| %>
      <div class="row-fluid">
        <div id="<%= issue_vote.anchor %>" class="span7">
          <h3><%= issue_vote.title %></h3>
          <p><%= raw(markdown(issue_vote.comment)) %></p>
        </div>

        <div class="span5">
          <div class="vote-fact-box">
            <small>
              <p><strong>Dato:</strong> <%= issue_vote.time_text %></p>
              <p><strong>Type:</strong> <%= issue_vote.proposition_type_text %></p>
              <p><strong>Vekt:</strong> <%= link_to issue_vote.weight_text, home_method_path(anchor: 'vekting-av-avstemninger') %></p>
              <p><%= issue_vote.enacted_text.html_safe %></p>
              <p><%= issue_vote.matches_text.html_safe %> </p>
            </small>
          </div>
        </div>
      </div>

      <%= render partial: 'vote_table', locals: { all_parties: @all_parties, issue_vote: issue_vote } %>
      <hr class="soften">
    <% end %>
  </div>
<% end # cache %>

<% content_for :document_ready do %>
  <script>
    $(document).ready(function () {
      HDO.voteRowToggler.create({
        columns: $('.state-column') }
      ).init();
    });
  </script>
<% end %>
