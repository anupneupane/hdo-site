<% page_title "#{@representative.full_name} - #{Representative.model_name.human(count: 2).capitalize} - #{t('app.title')}" %>
<% party = @representative.latest_party %>

<div class="representative-profile">
  <%= image_tag @representative.image.versions[:medium], width: '240', height: '320', class: 'representative-image', alt: @representative.full_name %>
  <h1 class="representative-name"><%= @representative.full_name %> (<%= @representative.age %>)</h1>

  <span class="representative-district">
    <%= link_to @representative.district.name, @representative.district %>
  </span>
  <span class="representative-party">
    <%= party && link_to(party.name, party, class:party.external_id) %>
  </span>

  <dl class="representative-comitee-list">
    <% @representative.current_committees.each do |com| %>
      <dd>Medlem av <%= link_to com.name, com %></dd>
    <% end %>
  </dl>

</div>

<hr class="soften">

<h3>Twitter <a href="http://twitter.com/<%= @representative.twitter_id %>" class="muted">(@<%= @representative.twitter_id %>)</a></h3>
<div id="representative-tweets">
  <span class="muted">Henter kvitter...</span>
</div>

<% content_for :document_ready do %>
<script>
  $(function() {
    var representative = "<%= @representative.twitter_id %>";
    $.getJSON("http://search.twitter.com/search.json?q=from%3A" + representative + "&callback=?",
      function (data) {
        var tweets = "<div class='row-fluid'>"
        $(data.results).each(function(index) {
          if (index < 6) {
            var tweet = this;
            tweets += "<article class='span4'>" + tweet.text + "</article>";
            if ((index+2) % 3 == 1) {
              tweets += "</div><div class='row-fluid'>"
            }
          }
        });
        tweets += "</div>";
        $('#representative-tweets').html(tweets);
      }
    );
  });
</script>
<% end %>

<hr>

<div>
  <h3>Avstemninger</h3>
  <ul class="parties-issue-list">
    <% @issues.each do |issue| %>
      <li>
        <%= issue.stats.text_for(@representative, html: true) %>
        <%= t 'app.lang.infinitive_particle' %>
        <%= link_to issue.downcased_title, issue %>.
      </li>
    <% end %>
  </ul>
</div>

